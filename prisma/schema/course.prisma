enum audience_target {
  participant
  accelerator
}

enum module_category {
  article
  quiz
  assignment
}

enum submission_status {
  in_progress
  submitted
  graded
}

model courses_participants {
  id        String @id @default(uuid())
  course_id String
  user_id   String

  enrolled_at DateTime  @default(now())
  finished_at DateTime?

  course courses @relation(fields: [course_id], references: [id], onDelete: Cascade)

  @@unique([course_id, user_id])
}

model courses {
  id          String   @id @default(uuid())
  title       String
  description String?
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt

  asesor_id String?

  asesor users? @relation(fields: [asesor_id], references: [id], onDelete: SetNull)

  stage stage

  classification  String?
  audience_target audience_target

  course_type course_type @default(mandatory)
  regional    String?

  is_published Boolean   @default(false)
  published_at DateTime?

  modules               course_modules[]
  courses_participants  courses_participants[]
  course_item_submissions course_item_submissions[]

  @@map("courses")
}

enum course_type {
  mandatory
  elective
}

model course_modules {
  id        String @id @default(uuid())
  course_id String

  title       String
  description String?
  sequence    Int

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  course courses @relation(fields: [course_id], references: [id], onDelete: Cascade)

  items                     course_module_items[]
  course_module_completions course_module_completions[]
}

model course_module_items {
  id        String @id @default(uuid())
  module_id String

  title    String
  category module_category
  sequence Int

  data Json

  is_published Boolean @default(true)

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  module course_modules @relation(fields: [module_id], references: [id], onDelete: Cascade)

  submissions                    course_item_submissions[]
  course_module_item_completions course_module_item_completions[]
}
